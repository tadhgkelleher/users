<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fractal Cymatics: Rhythm of the Void</title>
  <style>
    body {
      font-family: 'Orbitron', sans-serif;
      text-align: center;
      background: linear-gradient(135deg, #1a1a3b, #2a2a5c, #3b3b7d);
      color: #e0e0ff;
      margin: 0;
      padding: 20px;
      overflow: hidden;
      animation: subtleShift 30s infinite alternate;
    }

    @keyframes subtleShift {
      0% { background: linear-gradient(135deg, #1a1a3b, #2a2a5c, #3b3b7d); }
      50% { background: linear-gradient(135deg, #2a1a5c, #3b2a7d, #4c3b9e); }
      100% { background: linear-gradient(135deg, #1a2a5c, #2a3b7d, #3b4c9e); }
    }

    h1 {
      font-size: 3rem;
      color: #9b59b6;
      text-shadow: 0 0 10px #9b59b6, 0 0 20px #ff6ec7;
      animation: resonate 3s infinite alternate;
      margin-bottom: 25px;
    }

    @keyframes resonate {
      0% { text-shadow: 0 0 10px #9b59b6, 0 0 20px #ff6ec7; }
      100% { text-shadow: 0 0 15px #9b59b6, 0 0 30px #ff6ec7; }
    }

    #canvasContainer {
      position: relative;
      width: 800px;
      height: 800px;
      margin: 0 auto;
    }

    canvas {
      position: absolute;
      top: 0;
      left: 0;
      border: 2px solid #4c4c7d;
      border-radius: 10px;
      background: #0a0a1f;
      box-shadow: 0 0 40px rgba(155, 89, 182, 0.5), inset 0 0 15px rgba(0, 0, 0, 0.8);
      transition: transform 0.3s;
    }

    canvas:hover {
      transform: scale(1.02);
      box-shadow: 0 0 60px rgba(255, 110, 199, 0.7);
    }

    #particleCanvas {
      z-index: 1;
    }

    .controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      background: rgba(20, 20, 40, 0.9);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(155, 89, 182, 0.3);
      margin-bottom: 20px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }

    .control-panel {
      background: linear-gradient(135deg, #2e2e5c, #3e3e7d);
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
    }

    button, select {
      background: linear-gradient(45deg, #9b59b6, #ff6ec7);
      padding: 8px 15px;
      border: none;
      border-radius: 6px;
      color: #fff;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 0 10px rgba(155, 89, 182, 0.5);
    }

    button:hover, select:hover {
      background: linear-gradient(45deg, #ff6ec7, #9b59b6);
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(255, 110, 199, 0.8);
    }

    input[type="range"], input[type="number"] {
      background: #3e3e7d;
      border-radius: 6px;
      padding: 5px;
      color: #ff6ec7;
      accent-color: #ff6ec7;
    }

    input[type="color"] {
      width: 40px;
      height: 25px;
      border: 2px solid #9b59b6;
      border-radius: 6px;
      background: none;
      cursor: pointer;
    }

    label {
      color: #e0e0ff;
      font-size: 13px;
      text-shadow: 0 0 3px rgba(155, 89, 182, 0.4);
    }

    .parameter_input {
      position: relative;
      padding: 8px;
      text-align: left;
    }

    .tooltip {
      background: rgba(20, 20, 40, 0.9);
      color: #ff6ec7;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 11px;
      opacity: 0;
      transition: opacity 0.3s;
      position: absolute;
      top: -30px;
      left: 50%;
      transform: translateX(-50%);
    }

    .parameter_input:hover .tooltip {
      opacity: 1;
    }

    .tab-container {
      margin-bottom: 15px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }

    .tab {
      background: #3e3e7d;
      padding: 8px 15px;
      border-radius: 6px 6px 0 0;
      color: #e0e0ff;
      cursor: pointer;
    }

    .tab.active {
      background: #9b59b6;
      color: #fff;
    }

    .tab-content {
      display: none;
      background: rgba(20, 20, 40, 0.9);
      padding: 15px;
      border-radius: 0 0 10px 10px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }

    .tab-content.active {
      display: block;
    }

    @media (max-width: 768px) {
      .controls {
        grid-template-columns: 1fr;
      }
      #canvasContainer {
        width: 100%;
        height: auto;
      }
      canvas {
        width: 100%;
        height: auto;
      }
    }
  </style>
</head>
<body>
  <h1>Fractal Cymatics: Rhythm of the Void</h1>

  <div class="tab-container">
    <button class="tab active" onclick="openTab(event, 'formTab')">Form</button>
    <button class="tab" onclick="openTab(event, 'rhythmTab')">Rhythm</button>
    <button class="tab" onclick="openTab(event, 'voidTab')">Void</button>
  </div>

  <div id="formTab" class="tab-content active">
    <div class="control-panel">
      <div class="controls">
        <div class="parameter_input">
          <span class="tooltip">Number of segments</span>
          <label for="segments">Segments</label>
          <input type="range" id="segments" value="12" min="3" max="60" oninput="updateValue('segments')">
          <span id="segments-value">12</span>
        </div>
        <div class="parameter_input">
          <span class="tooltip">Recursion depth</span>
          <label for="levels">Levels</label>
          <input type="range" id="levels" value="4" min="1" max="15" oninput="updateValue('levels')">
          <span id="levels-value">4</span>
        </div>
        <div class="parameter_input">
          <span class="tooltip">Scale reduction</span>
          <label for="scaleFactor">Scale</label>
          <input type="range" id="scaleFactor" value="0.5" min="0.1" max="0.9" step="0.01" oninput="updateValue('scaleFactor')">
          <span id="scaleFactor-value">0.5</span>
        </div>
        <div class="parameter_input">
          <span class="tooltip">Base amplitude</span>
          <label for="initialRadius">Amplitude</label>
          <input type="range" id="initialRadius" value="150" min="50" max="350" oninput="updateValue('initialRadius')">
          <span id="initialRadius-value">150</span>
        </div>
        <div class="parameter_input">
          <span class="tooltip">Core color</span>
          <label for="lineColor">Core Color</label>
          <input type="color" id="lineColor" value="#9b59b6">
        </div>
      </div>
    </div>
  </div>

  <div id="rhythmTab" class="tab-content">
    <div class="control-panel">
      <div class="controls">
        <div class="parameter_input">
          <span class="tooltip">Wave thickness</span>
          <label for="lineWidth">Density</label>
          <input type="range" id="lineWidth" value="2" min="0.5" max="10" step="0.1" oninput="updateValue('lineWidth')">
          <span id="lineWidth-value">2</span>
        </div>
        <div class="parameter_input">
          <span class="tooltip">Base frequency (Hz)</span>
          <label for="baseFreq">Base Freq</label>
          <input type="range" id="baseFreq" value="432" min="20" max="1000" step="10" oninput="updateValue('baseFreq')">
          <span id="baseFreq-value">432</span>
        </div>
        <div class="parameter_input">
          <span class="tooltip">Musical key or sacred freq</span>
          <label for="key">Key/Freq</label>
          <select id="key" onchange="updateValue('key')">
            <option value="432">432 Hz (Sacred)</option>
            <option value="528">528 Hz (Healing)</option>
            <option value="C">C Major</option>
            <option value="G">G Major</option>
            <option value="Fm">F Minor</option>
            <option value="Em">E Minor</option>
          </select>
        </div>
        <div class="parameter_input">
          <span class="tooltip">Time signature (beats)</span>
          <label for="timeSignature">Time Sig</label>
          <select id="timeSignature" onchange="updateValue('timeSignature')">
            <option value="4/4">4/4</option>
            <option value="3/4">3/4</option>
            <option value="5/4">5/4</option>
            <option value="7/8">7/8</option>
          </select>
        </div>
        <div class="parameter_input">
          <span class="tooltip">Beats per minute</span>
          <label for="bpm">BPM</label>
          <input type="range" id="bpm" value="120" min="60" max="240" step="5" oninput="updateValue('bpm')">
          <span id="bpm-value">120</span>
        </div>
        <div class="parameter_input">
          <span class="tooltip">Waveform type</span>
          <label for="waveform">Waveform</label>
          <select id="waveform" onchange="updateValue('waveform')">
            <option value="sine">Sine</option>
            <option value="sawtooth">Sawtooth</option>
            <option value="square">Square</option>
            <option value="triangle">Triangle</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <div id="voidTab" class="tab-content">
    <div class="control-panel">
      <h3>Void Dimensions</h3>
      <div class="controls">
        <div class="parameter_input">
          <span class="tooltip">Particle density</span>
          <label for="particleDensity">Particles</label>
          <input type="range" id="particleDensity" value="50" min="0" max="300" oninput="updateValue('particleDensity')">
          <span id="particleDensity-value">50</span>
        </div>
        <div class="parameter_input">
          <span class="tooltip">3D rotation speed</span>
          <label for="rotationSpeed">Rotation</label>
          <input type="range" id="rotationSpeed" value="1" min="0" max="5" step="0.1" oninput="updateValue('rotationSpeed')">
          <span id="rotationSpeed-value">1</span>
        </div>
        <div class="parameter_input">
          <span class="tooltip">Depth perception</span>
          <label for="depth">Depth</label>
          <input type="range" id="depth" value="0.5" min="0" max="1" step="0.1" oninput="updateValue('depth')">
          <span id="depth-value">0.5</span>
        </div>
        <div class="parameter_input">
          <span class="tooltip">Pattern type</span>
          <label for="patternType">Pattern</label>
          <select id="patternType" onchange="updateValue('patternType')">
            <option value="cymatic">Cymatic</option>
            <option value="vortex">Vortex</option>
            <option value="nebula">Nebula</option>
            <option value="chaos">Chaos</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <div class="controls">
    <button id="generate">Weave Rhythm</button>
    <button id="random">Void Pulse</button>
    <button id="animate">Resonate 3D</button>
    <button id="download">Capture Void</button>
  </div>

  <div id="canvasContainer">
    <canvas id="mandalaCanvas" width="800" height="800"></canvas>
    <canvas id="particleCanvas" width="800" height="800"></canvas>
  </div>

  <script>
    const canvas = document.getElementById('mandalaCanvas');
    const ctx = canvas.getContext('2d');
    const particleCanvas = document.getElementById('particleCanvas');
    const particleCtx = particleCanvas.getContext('2d');

    let animationId = null;
    let isAnimating = false;
    let particles = [];
    let audioContext = null;
    let oscillators = [];
    let rhythmGain = null;
    let beatCounter = 0;
    let rotationAngle = 0;

    // Sacred frequencies and musical keys
    const frequencies = {
      '432': [432], // Sacred healing frequency
      '528': [528], // Transformation and miracles
      'C': [261.63, 329.63, 392.00], // C Major: C4, E4, G4
      'G': [392.00, 493.88, 587.33], // G Major: G4, B4, D5
      'Fm': [349.23, 415.30, 466.16], // F Minor: F4, G#4, A#4
      'Em': [329.63, 415.30, 493.88]  // E Minor: E4, G#4, B4
    };

    // Initialize audio only after user gesture
    function initAudio() {
      if (!audioContext) {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        console.log("AudioContext initialized");
        if (audioContext.state === 'suspended') {
          audioContext.resume();
        }
        updateFrequencies();
      } else if (audioContext.state === 'suspended') {
        audioContext.resume().then(() => {
          console.log("AudioContext resumed");
          updateFrequencies();
        });
      } else {
        updateFrequencies();
      }
    }

    function updateFrequencies() {
      oscillators.forEach(osc => osc.stop());
      oscillators = [];
      if (rhythmGain) rhythmGain.disconnect();

      const key = document.getElementById('key').value;
      const baseFreq = parseFloat(document.getElementById('baseFreq').value);
      const waveform = document.getElementById('waveform').value;
      const bpm = parseInt(document.getElementById('bpm').value);
      const timeSignature = document.getElementById('timeSignature').value;
      const beats = parseInt(timeSignature.split('/')[0]);

      const freqs = frequencies[key] || [baseFreq];
      freqs.forEach(freq => {
        const osc = audioContext.createOscillator();
        rhythmGain = audioContext.createGain();
        osc.type = waveform;
        osc.frequency.value = freq;
        rhythmGain.gain.value = 0; // Start silent, controlled by rhythm
        osc.connect(rhythmGain);
        rhythmGain.connect(audioContext.destination);
        osc.start();
        oscillators.push(osc);
      });

      // Rhythm generator
      const beatInterval = 60000 / bpm; // ms per beat
      let beatIndex = 0;
      clearInterval(window.rhythmInterval); // Clear any existing interval
      window.rhythmInterval = setInterval(() => {
        rhythmGain.gain.setValueAtTime(0.2, audioContext.currentTime);
        rhythmGain.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.1);
        beatIndex = (beatIndex + 1) % beats;
        beatCounter = beatIndex;
      }, beatInterval);
    }

    // Particle system with 3D effect
    class Particle {
      constructor() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.z = Math.random() * 200 - 100; // Depth
        this.size = Math.random() * 5 + 1;
        this.speedX = Math.random() * 2 - 1;
        this.speedY = Math.random() * 2 - 1;
        this.speedZ = Math.random() * 1 - 0.5;
        this.life = Math.random() * 100;
      }

      update(audioFactor) {
        this.x += this.speedX * audioFactor;
        this.y += this.speedY * audioFactor;
        this.z += this.speedZ * audioFactor;
        this.life -= 1;
        if (this.x < 0 || this.x > canvas.width) this.speedX *= -1;
        if (this.y < 0 || this.y > canvas.height) this.speedY *= -1;
        if (this.z < -100 || this.z > 100) this.speedZ *= -1;
      }

      draw(audioFactor) {
        const depthFactor = 1 - (this.z + 100) / 200; // 0 to 1
        const size = this.size * depthFactor * audioFactor;
        particleCtx.fillStyle = `rgba(255, 110, 199, ${this.life / 100 * depthFactor})`;
        particleCtx.beginPath();
        particleCtx.arc(this.x, this.y, size, 0, Math.PI * 2);
        particleCtx.fill();
      }
    }

    function initParticles() {
      particles = [];
      const density = parseInt(document.getElementById('particleDensity').value);
      for (let i = 0; i < density; i++) {
        particles.push(new Particle());
      }
      console.log("Particles initialized:", particles.length);
    }

    function animateParticles(audioFactor) {
      particleCtx.clearRect(0, 0, canvas.width, canvas.height);
      particles.forEach((p, i) => {
        p.update(audioFactor);
        p.draw(audioFactor);
        if (p.life <= 0) particles.splice(i, 1);
      });
      const targetDensity = parseInt(document.getElementById('particleDensity').value);
      while (particles.length < targetDensity) {
        particles.push(new Particle());
      }
    }

    // Core initialization
    function init() {
      console.log("Initializing...");
      document.getElementById('generate').addEventListener('click', () => {
        initAudio();
        generateMandala();
      });
      document.getElementById('random').addEventListener('click', () => {
        initAudio();
        randomizeMandala();
      });
      document.getElementById('download').addEventListener('click', downloadMandala);
      document.getElementById('animate').addEventListener('click', () => {
        initAudio();
        toggleAnimation();
      });
      updateValueDisplays();
      initParticles();
      generateMandala(); // Initial render
      console.log("Init complete, canvas should be visible");
    }

    function updateValueDisplays() {
      document.getElementById('segments-value').textContent = document.getElementById('segments').value;
      document.getElementById('levels-value').textContent = document.getElementById('levels').value;
      document.getElementById('scaleFactor-value').textContent = document.getElementById('scaleFactor').value;
      document.getElementById('initialRadius-value').textContent = document.getElementById('initialRadius').value;
      document.getElementById('lineWidth-value').textContent = document.getElementById('lineWidth').value;
      document.getElementById('baseFreq-value').textContent = document.getElementById('baseFreq').value;
      document.getElementById('bpm-value').textContent = document.getElementById('bpm').value;
      document.getElementById('particleDensity-value').textContent = document.getElementById('particleDensity').value;
      document.getElementById('rotationSpeed-value').textContent = document.getElementById('rotationSpeed').value;
      document.getElementById('depth-value').textContent = document.getElementById('depth').value;
    }

    function updateValue(id) {
      updateValueDisplays();
      if (!isAnimating) generateMandala();
      if (id === 'particleDensity') initParticles();
      if (audioContext && ['baseFreq', 'key', 'waveform', 'bpm', 'timeSignature'].includes(id)) updateFrequencies();
    }

    function generateMandala() {
      console.log("Generating mandala...");
      const segments = parseInt(document.getElementById('segments').value);
      const levels = parseInt(document.getElementById('levels').value);
      const scaleFactor = parseFloat(document.getElementById('scaleFactor').value);
      const radius = parseInt(document.getElementById('initialRadius').value);
      const lineColor = document.getElementById('lineColor').value;
      const lineWidth = parseFloat(document.getElementById('lineWidth').value);
      const patternType = document.getElementById('patternType').value;
      const depth = parseFloat(document.getElementById('depth').value);

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;

      ctx.save();
      ctx.translate(centerX, centerY);
      ctx.rotate(rotationAngle);
      ctx.translate(-centerX, -centerY);

      function drawRecursiveShape(x, y, r, level, audioFactor = 1) {
        if (level > levels) return;

        const gradient = ctx.createRadialGradient(x, y, r * 0.3, x, y, r);
        gradient.addColorStop(0, lineColor);
        gradient.addColorStop(1, `hsl(${level * 20}, 80%, 50%)`);

        ctx.lineWidth = lineWidth * (1 - (level-1) / levels * 0.7) * audioFactor;
        ctx.strokeStyle = gradient;
        ctx.shadowBlur = 15 + level * 5;
        ctx.shadowColor = lineColor;

        const zOffset = Math.sin(level * 0.5) * depth * 20;

        switch (patternType) {
          case 'cymatic':
            drawCymatic(x, y + zOffset, r, level, audioFactor);
            break;
          case 'vortex':
            drawVortex(x, y + zOffset, r, segments / level);
            break;
          case 'nebula':
            drawNebula(x, y + zOffset, r);
            break;
          case 'chaos':
            drawChaos(x, y + zOffset, r, level);
            break;
        }

        drawRecursiveShape(x, y, r * scaleFactor, level + 1, audioFactor);
      }

      function drawCymatic(x, y, r, level, audioFactor) {
        ctx.beginPath();
        const points = segments;
        for (let i = 0; i < points; i++) {
          const angle = (i / points) * Math.PI * 2;
          const mod = Math.sin(angle * level + Date.now() * 0.001) * audioFactor;
          const dist = r * (0.5 + mod * 0.5);
          ctx.lineTo(x + Math.cos(angle) * dist, y + Math.sin(angle) * dist);
        }
        ctx.closePath();
        ctx.stroke();
      }

      function drawVortex(x, y, r, segments) {
        ctx.beginPath();
        for (let i = 0; i < segments; i++) {
          const angle = (i / segments) * Math.PI * 2;
          const x1 = x + r * Math.cos(angle);
          const y1 = y + r * Math.sin(angle);
          const x2 = x + r * 0.5 * Math.cos(angle + Math.PI / segments);
          const y2 = y + r * 0.5 * Math.sin(angle + Math.PI / segments);
          ctx.moveTo(x, y);
          ctx.quadraticCurveTo(x1, y1, x2, y2);
        }
        ctx.stroke();
      }

      function drawNebula(x, y, r) {
        ctx.beginPath();
        for (let i = 0; i < 6; i++) {
          const angle = (i / 6) * Math.PI * 2 + Math.random() * 0.2;
          const dist = r * (0.5 + Math.random() * 0.5);
          ctx.lineTo(x + Math.cos(angle) * dist, y + Math.sin(angle) * dist);
        }
        ctx.closePath();
        ctx.stroke();
      }

      function drawChaos(x, y, r, level) {
        ctx.beginPath();
        const points = Math.floor(Math.random() * 5) + 3;
        for (let i = 0; i < points; i++) {
          const angle = (i / points) * Math.PI * 2 + Math.random() * 0.3;
          const dist = r * (0.3 + Math.random() * 0.7);
          ctx.lineTo(x + Math.cos(angle) * dist, y + Math.sin(angle) * dist);
        }
        ctx.closePath();
        ctx.stroke();
      }

      const audioFactor = 1 + Math.sin(Date.now() * 0.001 + beatCounter * 0.5) * 0.5;
      for (let i = 0; i < segments; i++) {
        const angle = (i / segments) * Math.PI * 2;
        const x = centerX + radius * Math.cos(angle);
        const y = centerY + radius * Math.sin(angle);
        drawRecursiveShape(x, y, radius * scaleFactor, 1, audioFactor);
      }

      ctx.restore();
      console.log("Mandala rendered");
    }

    function randomizeMandala() {
      document.getElementById('segments').value = Math.floor(Math.random() * 57) + 3;
      document.getElementById('levels').value = Math.floor(Math.random() * 14) + 1;
      document.getElementById('scaleFactor').value = (Math.random() * 0.8 + 0.1).toFixed(2);
      document.getElementById('initialRadius').value = Math.floor(Math.random() * 300) + 50;
      document.getElementById('lineWidth').value = (Math.random() * 9.5 + 0.5).toFixed(1);
      document.getElementById('baseFreq').value = Math.floor(Math.random() * 980) + 20;
      document.getElementById('bpm').value = Math.floor(Math.random() * 180) + 60;
      document.getElementById('key').value = ['432', '528', 'C', 'G', 'Fm', 'Em'][Math.floor(Math.random() * 6)];
      document.getElementById('timeSignature').value = ['4/4', '3/4', '5/4', '7/8'][Math.floor(Math.random() * 4)];
      document.getElementById('waveform').value = ['sine', 'sawtooth', 'square', 'triangle'][Math.floor(Math.random() * 4)];
      document.getElementById('particleDensity').value = Math.floor(Math.random() * 300);
      document.getElementById('rotationSpeed').value = (Math.random() * 5).toFixed(1);
      document.getElementById('depth').value = (Math.random() * 1).toFixed(1);
      document.getElementById('patternType').value = ['cymatic', 'vortex', 'nebula', 'chaos'][Math.floor(Math.random() * 4)];
      document.getElementById('lineColor').value = randomColor();
      updateValueDisplays();
      initParticles();
      generateMandala();
    }

    function randomColor() {
      return '#' + Math.floor(Math.random() * 16777215).toString(16);
    }

    function downloadMandala() {
      const link = document.createElement('a');
      link.download = 'rhythm-void.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
    }

    function toggleAnimation() {
      if (isAnimating) {
        cancelAnimationFrame(animationId);
        document.getElementById('animate').textContent = 'Resonate 3D';
        isAnimating = false;
      } else {
        document.getElementById('animate').textContent = 'Collapse Void';
        isAnimating = true;
        animate();
      }
    }

    function animate() {
      const rotationSpeed = parseFloat(document.getElementById('rotationSpeed').value);
      const audioFactor = 1 + Math.sin(Date.now() * 0.001 + beatCounter * 0.5) * 0.5;
      rotationAngle += rotationSpeed * 0.01;

      document.getElementById('initialRadius').value = 150 + Math.sin(Date.now() * 0.001) * 50 * audioFactor;
      document.getElementById('scaleFactor').value = (0.5 + Math.cos(Date.now() * 0.0005) * 0.4).toFixed(2);

      updateValueDisplays();
      generateMandala();
      animateParticles(audioFactor);

      if (isAnimating) animationId = requestAnimationFrame(animate);
    }

    function openTab(evt, tabName) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.getElementById(tabName).classList.add('active');
      evt.currentTarget.classList.add('active');
    }

    window.onload = () => {
      console.log("Window loaded");
      init();
    };
  </script>
</body>
</html>
