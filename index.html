<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Mandala - Your Digital Sanctuary for Creativity & Mindfulness</title>
    
    <!-- Google AdSense Script -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5470051995144012"
     crossorigin="anonymous"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,600;1,400&family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #4a148c; --secondary-color: #8e24aa; --accent-color: #ffab40;
            --text-color: #333; --bg-color: #f4f2f7; --light-gray: #e0e0e0;
        }
        body { font-family: 'Lora', serif; line-height: 1.7; margin: 0; background-color: var(--bg-color); color: var(--text-color); }
        body.modal-open { overflow: hidden; }
        .container { max-width: 1200px; margin: auto; padding: 0 20px; }
        header { background: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.1); padding: 1rem 0; position: sticky; top: 0; z-index: 1000; }
        nav { display: flex; justify-content: space-between; align-items: center; font-family: 'Montserrat', sans-serif; }
        .logo { font-size: 1.5rem; font-weight: 700; color: var(--primary-color); text-decoration: none; cursor: pointer; }
        nav ul { list-style: none; display: flex; margin: 0; padding: 0; }
        nav ul li { margin-left: 25px; }
        nav ul li a { text-decoration: none; color: var(--secondary-color); font-weight: 600; cursor: pointer; transition: color 0.3s ease, border-bottom-color 0.3s ease; padding: 10px 5px; border-bottom: 2px solid transparent; }
        nav ul li a:hover, nav ul li a.active { color: var(--accent-color); border-bottom-color: var(--accent-color); }
        .view { display: none; padding: 40px 0; animation: fadeIn 0.5s ease-in-out; }
        .view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .section-title { font-family: 'Montserrat', sans-serif; font-size: 2.5rem; color: var(--primary-color); margin-bottom: 40px; text-align: center; }
        #creator-view .creator-layout { display: grid; grid-template-columns: 300px 1fr; gap: 30px; align-items: flex-start; }
        #mandalaCanvas { background: #fff; border: 1px solid var(--light-gray); border-radius: 10px; cursor: crosshair; box-shadow: 0 5px 15px rgba(0,0,0,0.1); width: 100%; height: auto; touch-action: none; }
        .controls { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .control-group { margin-bottom: 25px; }
        .control-group h3 { font-family: 'Montserrat', sans-serif; font-size: 1.1rem; color: var(--secondary-color); margin-top: 0; margin-bottom: 15px; border-bottom: 1px solid var(--light-gray); padding-bottom: 10px; }
        .color-palette { display: grid; grid-template-columns: repeat(auto-fill, minmax(30px, 1fr)); gap: 10px; }
        .color-box { width: 30px; height: 30px; border-radius: 50%; cursor: pointer; border: 3px solid transparent; transition: border-color 0.2s; }
        .color-box.active { border-color: var(--accent-color); }
        .slider-group, .checkbox-group, .button-style-group { display: flex; flex-direction: column; }
        .slider-group label, .checkbox-group label { font-family: 'Montserrat'; margin-bottom: 5px; font-size: 0.9rem; }
        .slider-group input[type="range"] { width: 100%; }
        .checkbox-group { flex-direction: row; align-items: center; gap: 10px; }
        .button-style-group div { display: flex; gap: 10px; }
        .style-btn { flex: 1; padding: 8px; border: 2px solid var(--light-gray); background: #fff; border-radius: 5px; cursor: pointer; }
        .style-btn.active { border-color: var(--primary-color); background: var(--bg-color); }
        .button-group { display: flex; flex-direction: column; gap: 10px; }
        .btn { background: var(--primary-color); color: #fff; border: none; padding: 12px 15px; font-family: 'Montserrat'; font-weight: 600; border-radius: 5px; cursor: pointer; transition: background-color 0.3s; text-align: center; }
        .btn:hover { background: var(--secondary-color); }
        .btn.accent { background: var(--accent-color); }
        .btn.accent:hover { background: #ffc107; }
        .btn.secondary { background-color: #757575; }
        .btn.secondary:hover { background-color: #9e9e9e; }
        .mobile-actions { display: none; }
        .article-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
        .article-card { background: #fff; padding: 25px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); display: flex; flex-direction: column; }
        .article-card h3 { font-family: 'Montserrat', sans-serif; color: var(--secondary-color); margin-top: 0; }
        .article-card .summary { flex-grow: 1; }
        .article-card .read-more-link { font-family: 'Montserrat'; color: var(--primary-color); text-decoration: none; font-weight: 600; cursor: pointer; }
        .article-card .read-more-link:hover { color: var(--accent-color); }
        .full-text { display: none; }
        .gallery-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
        .gallery-item { position: relative; overflow: hidden; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); aspect-ratio: 1 / 1; }
        .gallery-item img { width: 100%; height: 100%; object-fit: cover; display: block; transition: transform 0.4s ease; }
        .gallery-item:hover img { transform: scale(1.1); }
        .gallery-item-actions { position: absolute; top: 10px; right: 10px; display: flex; gap: 8px; opacity: 0; transition: opacity 0.3s; }
        .gallery-item:hover .gallery-item-actions { opacity: 1; }
        .gallery-btn { background-color: rgba(0, 0, 0, 0.6); color: white; border: none; border-radius: 50%; width: 32px; height: 32px; font-size: 16px; line-height: 32px; text-align: center; cursor: pointer; }
        .gallery-btn.delete { background-color: rgba(229, 57, 53, 0.8); }
        .gallery-info { text-align: center; padding: 20px; background: #fff; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .page-content { max-width: 800px; margin: 0 auto; background: #fff; padding: 40px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .page-content h1, .page-content h2 { font-family: 'Montserrat'; color: var(--primary-color); }
        .page-content a { color: var(--secondary-color); }
        #article-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); display: flex; justify-content: center; align-items: center; z-index: 2000; opacity: 0; pointer-events: none; transition: opacity 0.3s ease-in-out; }
        #article-modal.visible { opacity: 1; pointer-events: auto; }
        .modal-content { background: #fff; padding: 40px; border-radius: 10px; max-width: 700px; width: 90%; max-height: 85vh; overflow-y: auto; position: relative; transform: scale(0.95); transition: transform 0.3s ease-in-out; }
        #article-modal.visible .modal-content { transform: scale(1); }
        .modal-content h2 { font-family: 'Montserrat', sans-serif; color: var(--primary-color); margin-top: 0; }
        .modal-content p, .modal-content li { line-height: 1.8; }
        .modal-content ul, .modal-content ol { padding-left: 20px; }
        .close-modal { position: absolute; top: 15px; right: 20px; font-size: 2rem; font-weight: bold; color: var(--light-gray); cursor: pointer; line-height: 1; }
        .close-modal:hover { color: var(--text-color); }
        footer { background-color: var(--primary-color); color: #fff; text-align: center; padding: 40px 20px; font-family: 'Montserrat', sans-serif; }
        footer a { color: var(--accent-color); margin: 0 10px; text-decoration: none; cursor: pointer; }

        @media (max-width: 800px) {
            #creator-view .creator-layout { grid-template-columns: 1fr; gap: 25px; }
            .controls .main-actions { display: none; }
            .mobile-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
            nav { flex-direction: column; gap: 15px; }
            nav ul { justify-content: center; flex-wrap: wrap; }
            nav ul li { margin: 0 10px; }
            .section-title { font-size: 2rem; }
            .logo { font-size: 1.3rem; }
            .view { padding: 30px 0; }
            .page-content { padding: 25px; }
        }
    </style>
</head>
<body>

    <header>
        <nav class="container">
            <a class="logo">my-mandala.com</a>
            <ul>
                <li><a data-view="creator-view" class="active">Create</a></li>
                <li><a data-view="library-view">Learn</a></li>
                <li><a data-view="gallery-view">My Gallery</a></li>
            </ul>
        </nav>
    </header>

    <main class="container">
        <section id="creator-view" class="view active">
            <h2 class="section-title">The Digital Mandala Creator</h2>
            <div class="creator-layout">
                <aside class="controls">
                    <div class="control-group"><h3>Brush Color</h3><div class="color-palette" id="colorPalette"></div></div>
                    <div class="control-group"><h3>Background</h3><div class="color-palette" id="bgPalette"></div></div>
                    <div class="control-group"><h3>Brush Style</h3>
                        <div class="slider-group"><label for="brushSize">Size: <span id="brushSizeValue">5</span>px</label><input type="range" id="brushSize" min="1" max="50" value="5"></div>
                        <div class="button-style-group" style="margin-top: 15px;"><label>Line Cap:</label><div><button class="style-btn active" data-linecap="round">Round</button><button class="style-btn" data-linecap="square">Square</button></div></div>
                        <div class="checkbox-group" style="margin-top: 15px;"><input type="checkbox" id="glowCheck"><label for="glowCheck">Glow Effect</label></div>
                    </div>
                    <div class="control-group"><h3>Symmetry</h3><div class="slider-group"><label for="sliceCount">Slices: <span id="sliceCountValue">12</span></label><input type="range" id="sliceCount" min="2" max="36" value="12" step="2"></div></div>
                    <div class="control-group button-group main-actions">
                        <button id="saveBtn" class="btn accent">Save to My Gallery</button>
                        <button id="downloadBtn" class="btn secondary">Download Image</button>
                        <button id="clearBtn" class="btn">Clear Canvas</button>
                    </div>
                </aside>
                <div>
                    <div class="canvas-container"><canvas id="mandalaCanvas"></canvas></div>
                    <div class="mobile-actions">
                         <button id="mobileSaveBtn" class="btn accent">Save to My Gallery</button>
                         <button id="mobileDownloadBtn" class="btn secondary">Download Image</button>
                    </div>
                </div>
            </div>
        </section>

        <section id="library-view" class="view">
            <h2 class="section-title">Library of Meanings</h2>
            <div class="article-grid">
                <div class="article-card">
                    <h3>The Symbolism of Color</h3>
                    <p class="summary">Colors are the soul of a mandala. Learn what red, blue, green, and other hues represent to infuse your creations with intention and meaning...</p>
                    <a class="read-more-link">Read More »</a>
                    <div class="full-text"><p>In the rich visual language of mandalas, colors are potent symbols that carry deep psychological and spiritual significance. Choosing your palette is the first step in setting the intention for your creation.</p><ul><li><strong>Red:</strong> The color of the root chakra, symbolizing strength, energy, passion, and the life force itself. Use it when you need courage, motivation, or a connection to the physical world.</li><li><strong>Orange:</strong> Linked to the sacral chakra, orange represents creativity, joy, sexuality, and emotional expression. It's a vibrant color for overcoming creative blocks and embracing pleasure.</li><li><strong>Yellow:</strong> Tied to the solar plexus chakra, yellow radiates intellect, confidence, and personal power. It's a wonderful color for mandalas intended to boost self-esteem and clarity of thought.</li><li><strong>Green:</strong> Resonating with the heart chakra, green is the color of nature, healing, growth, and balance. It brings a sense of peace and renewal, connecting us to the world around us.</li><li><strong>Blue:</strong> The color of the throat and third-eye chakras, blue invokes tranquility, wisdom, and spiritual devotion. It is ideal for meditative pieces aimed at enhancing communication and intuition.</li><li><strong>Purple/Violet:</strong> Connected to the crown chakra, purple elevates our consciousness, symbolizing royalty, magic, and our connection to the divine. It's the color of spiritual awakening and higher understanding.</li><li><strong>White:</strong> Representing purity, focus, and enlightenment. White can be used to create space, cleanse the visual palate, and symbolize a connection to a higher, unified consciousness.</li><li><strong>Black:</strong> A color of mystery, the unconscious, and deep potential. While sometimes seen as negative, in mandalas it often represents the void from which all creation emerges, offering a space for deep introspection.</li></ul></div>
                </div>
                <div class="article-card">
                    <h3>Understanding Sacred Geometry</h3>
                    <p class="summary">The universe is built on patterns. Explore the meaning of the circle, triangle, lotus, and other forms that give mandalas their power...</p>
                    <a class="read-more-link">Read More »</a>
                    <div class="full-text"><p>The universe is built on elegant mathematical patterns, and mandalas are a beautiful microcosm of this sacred architecture. Every line and shape holds a profound, archetypal meaning.</p><ul><li><strong>The Point (Bindu):</strong> The center of the mandala is the beginning—the seed of creation from which all else emerges. It represents non-duality, unity, and the source of all existence.</li><li><strong>The Circle:</strong> The most common mandala shape, the circle is a universal symbol of wholeness, eternity, the Self, and the cyclical nature of life. It provides a container for the sacred space within.</li><li><strong>The Triangle:</strong> A symbol of action and energy. Pointing up, it signifies aspiration towards the divine and masculine energy. Pointing down, it represents the grounding of spiritual energy into the material world and feminine energy.</li><li><strong>The Square:</strong> Often represents the physical world, stability, structure, and the four cardinal directions (North, South, East, West) or four elements (Earth, Air, Fire, Water).</li><li><strong>The Spiral:</strong> Represents the journey of growth, evolution, and the expansion of consciousness. A spiral moving outward can symbolize expression, while one moving inward can represent introspection.</li><li><strong>The Lotus Flower:</strong> A key symbol in Eastern traditions, the lotus represents enlightenment and spiritual awakening. Its roots are in the mud (the material world), but it blossoms into a beautiful flower above the water (spiritual realization).</li></ul></div>
                </div>
                <div class="article-card">
                    <h3>Mandalas for Mindfulness</h3>
                    <p class="summary">Discover how the simple act of creating a mandala can become a powerful form of active meditation, reducing stress and calming the mind...</p>
                    <a class="read-more-link">Read More »</a>
                    <div class="full-text"><p>In our fast-paced world, finding moments of true presence can be a challenge. Creating a mandala offers a powerful and accessible path to mindfulness through a process known as <strong>active meditation</strong>. Unlike passive meditation where one sits in silence, this practice engages the hands and eyes in a focused, repetitive task.</p><p>The focused repetition and the pursuit of symmetry command your full attention, effortlessly quieting the incessant chatter of the "monkey mind." This focused state, often called a <strong>"flow state,"</strong> is where you are fully immersed and energized by an activity. It leaves little room for anxious thoughts or external distractions.</p><p>Scientific studies have shown that such creative activities can lower heart rate, reduce blood pressure, and decrease levels of the stress hormone cortisol. It's not about achieving artistic perfection; the true benefit lies in the peaceful journey of creation. Each line drawn is a step back to your center, a moment of calm in the chaos of daily life. It allows you to process emotions non-verbally and find a sense of order and completion.</p></div>
                </div>
                <div class="article-card">
                    <h3>A Brief History of the Mandala</h3>
                    <p class="summary">From ancient Hindu texts and Tibetan sand paintings to modern therapeutic tools, explore the fascinating journey of the mandala through time...</p>
                    <a class="read-more-link">Read More »</a>
                    <div class="full-text"><p>The mandala, a Sanskrit word meaning "circle," is an ancient spiritual symbol with a rich history that spans cultures and millennia. Its origins can be traced back to the 4th century in India, where it was first mentioned in the Rigveda, one of the oldest sacred texts of Hinduism.</p><p>The practice was profoundly developed within <strong>Buddhism</strong>, particularly in the Vajrayana tradition of Tibet. Here, monks create intricate sand mandalas, painstakingly placing millions of grains of colored sand to form a map of the cosmos or the palace of a deity. The creation process is a form of meditation, and its eventual destruction symbolizes the core Buddhist teaching of impermanence.</p><p>Mandala-like patterns are not exclusive to the East. <strong>Native American</strong> cultures use the Medicine Wheel, a sacred circular hoop with intersecting lines, for healing and to represent the harmony of the universe. The intricate circular designs of <strong>Celtic knots</strong> and the rose windows of <strong>Gothic cathedrals</strong> also share the mandala's principles of a unified center and radiating symmetry.</p><p>Today, the mandala has been embraced by the West as a symbol of wholeness and a tool for self-exploration, largely thanks to the work of psychologist Carl Jung.</p></div>
                </div>
                <div class="article-card">
                    <h3>How to Meditate with a Mandala</h3>
                    <p class="summary">Your mandala is more than just art; it's a focus point for meditation. Learn a simple, step-by-step guide to use your creation for inner peace...</p>
                    <a class="read-more-link">Read More »</a>
                    <div class="full-text"><p>You can use a mandala you've created or one you find visually appealing as a powerful tool for meditation. This practice, known as trataka (yogic gazing), helps to focus the mind and promote a state of deep relaxation. Here’s a simple guide to get started:</p><ol><li><strong>Find a Quiet Space:</strong> Sit comfortably in a location where you won't be disturbed for 5-10 minutes. Hold your mandala or place your screen at a comfortable viewing distance.</li><li><strong>Set an Intention:</strong> Take a moment to consider what you hope to gain from this practice. It could be clarity on a problem, a sense of calm, or simply a moment of quiet.</li><li><strong>Begin with Your Breath:</strong> Take three deep, slow breaths. Inhale through your nose, and exhale slowly through your mouth. Allow your body to relax.</li><li><strong>Gaze Softly at the Center:</strong> Let your eyes rest gently on the central point (the bindu) of the mandala. Don't stare intensely; just maintain a soft, relaxed focus.</li><li><strong>Allow Your Awareness to Expand:</strong> After a minute or so, let your vision and awareness expand to take in the shapes and colors of the entire mandala. Notice the patterns, the symmetry, the flow of the design without judgment.</li><li><strong>Return to the Center:</strong> If your mind wanders (which it will!), gently guide your focus back to the center of the mandala. Use it as an anchor for your attention.</li><li><strong>Close with Gratitude:</strong> When you're ready to finish, gently close your eyes for a minute. Notice how you feel. Offer a sense of gratitude for this moment of peace.</li></ol></div>
                </div>
                <div class="article-card">
                    <h3>Carl Jung and the Mandala</h3>
                    <p class="summary">Famed psychologist Carl Jung saw the mandala as a "representation of the self." Understand the deep psychological meaning behind these circular designs...</p>
                    <a class="read-more-link">Read More »</a>
                    <div class="full-text"><p>The introduction of the mandala to Western psychology is largely credited to the Swiss psychiatrist <strong>Carl Jung</strong> (1875-1961). Jung encountered mandalas in his study of Eastern religions and was fascinated by their universal structure. He soon began to notice his patients spontaneously drawing circular images, especially during times of psychological stress or transformation.</p><p>Jung came to believe that the mandala is a profound archetypal symbol, an innate pattern within the human psyche. He saw it as a symbolic representation of the <strong>Self</strong>—the unified totality of an individual's consciousness and unconsciousness. He theorized that the urge to create mandalas emerges during moments of intense personal growth or disorientation, as the psyche naturally attempts to find order and re-center itself.</p><p>For Jung, the process of drawing a mandala was a "safe space" where the conflicting parts of the psyche could be contained and integrated. He encouraged his patients to create them as a way to map their inner landscape and facilitate the process of <strong>"individuation"</strong>—the lifelong journey of becoming a whole, integrated person. In this view, your mandala is not just a pretty picture; it is a snapshot of your inner world at a specific moment in time.</p></div>
                </div>
            </div>
        </section>

        <section id="gallery-view" class="view">
            <h2 class="section-title">My Personal Gallery</h2>
            <div id="galleryGrid" class="gallery-grid"></div>
        </section>

        <section id="about-view" class="view">
            <div class="page-content"><h1>About My-Mandala.com</h1><p>Welcome to My Mandala, your personal digital sanctuary for creativity and mindfulness. Our mission is to provide a peaceful and engaging space where anyone can explore the beautiful art of mandalas.</p><p>We believe in the therapeutic power of creation. The simple, repetitive act of drawing symmetrical patterns can be a profound form of active meditation, helping to calm the mind, reduce stress, and unlock inner creativity. Whether you're an experienced artist or someone just looking for a few moments of peace, our tools are designed for you.</p><p>This site was created with a passion for art, technology, and mental well-being. We hope our interactive creator and library of knowledge inspire you on your own journey of self-discovery.</p></div>
        </section>

        <section id="contact-view" class="view">
            <div class="page-content"><h1>Contact Us</h1><p>We'd love to hear from you! Whether you have a question, a suggestion, or just want to share your experience, please feel free to reach out.</p><p>For all inquiries, please contact us via email:</p><p><strong><a href="mailto:your-email@example.com">your-email@example.com</a></strong></p><p>We do our best to respond to all messages within 48 hours.</p></div>
        </section>

        <section id="privacy-view" class="view">
             <div class="page-content"><h1>Privacy Policy for My-Mandala.com</h1><p>Effective Date: [Insert Today's Date]</p><h2>1. Introduction</h2><p>Welcome to My-Mandala.com. We respect your privacy and are committed to protecting it. This Privacy Policy explains how we collect, use, and safeguard your information when you visit our website.</p><h2>2. Data We Collect</h2><p><strong>Personal Gallery Data:</strong> When you use the "Save to My Gallery" feature, the image data of your mandala is stored locally in your web browser's `localStorage`. This data is stored only on your computer and is not transmitted to our servers or any third party. We have no access to your personal gallery.</p><p><strong>Usage Data:</strong> Like most websites, we may collect non-personal information that your browser sends, such as your IP address, browser type, and pages visited, for analytical purposes.</p><h2>3. Third-Party Advertising (Google AdSense)</h2><p>We use Google AdSense to serve advertisements on our website. Google may use cookies or unique device identifiers to show you ads based on your prior visits to our website and other websites.</p><ul><li>Third-party vendors, including Google, use cookies to serve ads based on a user's prior visits to your website or other websites.</li><li>Google's use of advertising cookies enables it and its partners to serve ads to your users based on their visit to your sites and/or other sites on the Internet.</li><li>Users may opt out of personalized advertising by visiting <a href="https://www.google.com/settings/ads" target="_blank" rel="noopener noreferrer">Ads Settings</a>.</li></ul><h2>4. Your Rights</h2><p>Because your personal mandala gallery is stored locally, you have full control over it. You can delete individual mandalas or clear the entire gallery at any time using the buttons provided on the "My Gallery" page.</p><h2>5. Changes to This Policy</h2><p>We may update this Privacy Policy from time to time. We will notify you of any changes by posting the new policy on this page.</p></div>
        </section>
    </main>

    <div id="article-modal"><div class="modal-content"><span class="close-modal">×</span><h2 id="modal-title"></h2><div id="modal-body"></div></div></div>

    <footer>
        <p>© 2024 my-mandala.com. A sanctuary for creativity and mindfulness.</p>
        <p style="margin-top:15px;"><a data-view="about-view">About Us</a> |<a data-view="contact-view">Contact</a> |<a data-view="privacy-view">Privacy Policy</a></p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            function debounce(func, wait) { let timeout; return function(...args) { const context = this; clearTimeout(timeout); timeout = setTimeout(() => func.apply(context, args), wait); }; }

            const views = document.querySelectorAll('.view');
            const navLinks = document.querySelectorAll('nav ul li a');
            const footerLinks = document.querySelectorAll('footer a');
            const logo = document.querySelector('.logo');
            function showView(viewId) { views.forEach(v => v.classList.remove('active')); const t = document.getElementById(viewId); if (t) t.classList.add('active'); if (viewId === 'gallery-view') renderGallery(); navLinks.forEach(l => l.classList.toggle('active', l.dataset.view === viewId)); }
            navLinks.forEach(l => l.addEventListener('click', e => { e.preventDefault(); showView(l.dataset.view); }));
            footerLinks.forEach(l => l.addEventListener('click', e => { e.preventDefault(); showView(l.dataset.view); }));
            logo.addEventListener('click', () => showView('creator-view'));
            
            const modal = document.getElementById('article-modal'), modalTitle = document.getElementById('modal-title'), modalBody = document.getElementById('modal-body'), closeModalBtn = document.querySelector('.close-modal'), readMoreLinks = document.querySelectorAll('.read-more-link');
            function openModal(title, content) { modalTitle.textContent = title; modalBody.innerHTML = content; modal.classList.add('visible'); document.body.classList.add('modal-open'); }
            function closeModal() { modal.classList.remove('visible'); document.body.classList.remove('modal-open'); }
            readMoreLinks.forEach(link => { const card = link.closest('.article-card'); const title = card.querySelector('h3').textContent; const content = card.querySelector('.full-text').innerHTML; link.addEventListener('click', (e) => { e.preventDefault(); openModal(title, content); }); });
            closeModalBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', e => { if (e.target === modal) closeModal(); });
            document.addEventListener('keydown', e => { if (e.key === 'Escape' && modal.classList.contains('visible')) closeModal(); });
            
            const galleryGrid = document.getElementById('galleryGrid'), saveBtn = document.getElementById('saveBtn'), mobileSaveBtn = document.getElementById('mobileSaveBtn');
            function getMyMandalas() { return JSON.parse(localStorage.getItem('myMandalas') || '[]'); }
            function saveMyMandalas(mandalas) { localStorage.setItem('myMandalas', JSON.stringify(mandalas)); }
            function renderGallery() {
                const myMandalas = getMyMandalas(); galleryGrid.innerHTML = '';
                if (myMandalas.length === 0) { galleryGrid.innerHTML = `<div class="gallery-info"><p>Your personal gallery is empty.</p><p>Go to the 'Create' tab to design your first mandala and save it!</p></div>`; return; }
                myMandalas.forEach((data, index) => { const item = document.createElement('div'); item.className = 'gallery-item'; item.innerHTML = `<img src="${data.image}" alt="A user-saved mandala"><div class="gallery-item-actions"><button class="gallery-btn download" data-index="${index}" title="Download">↓</button><button class="gallery-btn delete" data-index="${index}" title="Delete">×</button></div>`; galleryGrid.appendChild(item); });
                const clearButton = document.createElement('button'); clearButton.textContent = 'Clear Entire Gallery'; clearButton.className = 'btn secondary'; clearButton.style.marginTop = '20px'; clearButton.style.gridColumn = '1 / -1'; clearButton.onclick = () => { if (confirm('Are you sure you want to delete all your saved mandalas? This cannot be undone.')) { saveMyMandalas([]); renderGallery(); } }; galleryGrid.appendChild(clearButton);
            }
            galleryGrid.addEventListener('click', e => {
                const target = e.target.closest('.gallery-btn');
                if (!target) return;
                const index = parseInt(target.dataset.index, 10);
                if (target.classList.contains('delete')) { let m = getMyMandalas(); m.splice(index, 1); saveMyMandalas(m); renderGallery(); }
                if (target.classList.contains('download')) { const m = getMyMandalas()[index]; if(m) downloadImage(m.image); }
            });
            function saveAction() { const imageData = canvas.toDataURL('image/png'); const myMandalas = getMyMandalas(); myMandalas.unshift({ image: imageData, date: new Date().toISOString() }); saveMyMandalas(myMandalas); saveBtn.textContent = 'Saved!'; mobileSaveBtn.textContent = 'Saved!'; setTimeout(() => { saveBtn.textContent = 'Save to My Gallery'; mobileSaveBtn.textContent = 'Save to My Gallery'; }, 1500); }
            saveBtn.addEventListener('click', saveAction); mobileSaveBtn.addEventListener('click', saveAction);

            const canvas = document.getElementById('mandalaCanvas'), ctx = canvas.getContext('2d');
            let isDrawing = false, currentLineWeight = 5, currentColor = '#4a148c', currentBgColor = '#ffffff', numSlices = 12, currentLineCap = 'round', glowEnabled = false, lastX = 0, lastY = 0;
            
            function redrawBackground() { ctx.fillStyle = currentBgColor; ctx.fillRect(0, 0, canvas.width, canvas.height); }
            function resizeCanvas() { const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height); const container = document.querySelector('.canvas-container'); const size = container.offsetWidth; canvas.width = size; canvas.height = size; redrawBackground(); ctx.putImageData(imageData, 0, 0); }
            window.addEventListener('resize', debounce(resizeCanvas, 250));
            
            const brushSizeSlider = document.getElementById('brushSize'), brushSizeValue = document.getElementById('brushSizeValue'), sliceCountSlider = document.getElementById('sliceCount'), sliceCountValue = document.getElementById('sliceCountValue'), clearBtn = document.getElementById('clearBtn'), downloadBtn = document.getElementById('downloadBtn'), mobileDownloadBtn = document.getElementById('mobileDownloadBtn'), colorPaletteContainer = document.getElementById('colorPalette'), bgPaletteContainer = document.getElementById('bgPalette'), lineCapBtns = document.querySelectorAll('.style-btn'), glowCheck = document.getElementById('glowCheck');
            
            const colors = ['#000000','#4a148c','#8e24aa','#d1c4e9','#e91e63','#f48fb1','#e53935','#ffcdd2','#ff9800','#ffab40','#cddc39','#aeea00','#4caf50','#a5d6a7','#00bcd4','#80deea','#2196f3','#90caf9','#ffffff','#616161'];
            const bgColors = ['#ffffff', '#f4f2f7', '#e0e0e0', '#9e9e9e', '#212121'];
            
            function createPalette(container, paletteColors, onColorSelect, activeColor) {
                paletteColors.forEach(color => { const box = document.createElement('div'); box.className = 'color-box'; box.style.backgroundColor = color; if (color === activeColor) box.classList.add('active'); box.addEventListener('click', () => { container.querySelector('.active')?.classList.remove('active'); box.classList.add('active'); onColorSelect(color); }); container.appendChild(box); });
            }
            createPalette(colorPaletteContainer, colors, color => currentColor = color, currentColor);
            createPalette(bgPaletteContainer, bgColors, color => { currentBgColor = color; redrawBackground(); }, currentBgColor);
            
            brushSizeSlider.oninput = e => { currentLineWeight = e.target.value; brushSizeValue.textContent = e.target.value; };
            sliceCountSlider.oninput = e => { numSlices = e.target.value; sliceCountValue.textContent = e.target.value; };
            clearBtn.onclick = () => { ctx.clearRect(0, 0, canvas.width, canvas.height); redrawBackground(); };
            function downloadImage(dataUrl) { const link = document.createElement('a'); link.download = `my-mandala-${Date.now()}.png`; link.href = dataUrl || canvas.toDataURL('image/png'); link.click(); }
            downloadBtn.addEventListener('click', () => downloadImage()); mobileDownloadBtn.addEventListener('click', () => downloadImage());
            lineCapBtns.forEach(btn => btn.addEventListener('click', () => { lineCapBtns.forEach(b => b.classList.remove('active')); btn.classList.add('active'); currentLineCap = btn.dataset.linecap; }));
            glowCheck.onchange = e => glowEnabled = e.target.checked;
            
            function draw(pos) { if (!isDrawing) return; const centerX = canvas.width / 2, centerY = canvas.height / 2, angle = (Math.PI * 2) / numSlices; for (let i = 0; i < numSlices; i++) { ctx.save(); ctx.translate(centerX, centerY); ctx.rotate(i * angle); ctx.lineCap = currentLineCap; ctx.strokeStyle = currentColor; ctx.lineWidth = currentLineWeight; if (glowEnabled) { ctx.shadowBlur = 15; ctx.shadowColor = currentColor; } else { ctx.shadowBlur = 0; } ctx.beginPath(); ctx.moveTo(lastX - centerX, lastY - centerY); ctx.lineTo(pos.x - centerX, pos.y - centerY); ctx.stroke(); ctx.moveTo(centerX - lastX, lastY - centerY); ctx.lineTo(centerX - pos.x, pos.y - centerY); ctx.stroke(); ctx.restore(); } [lastX, lastY] = [pos.x, pos.y]; }
            function startDrawing(e) { isDrawing = true; const pos = getPos(e); [lastX, lastY] = [pos.x, pos.y]; draw(pos); }
            function stopDrawing() { isDrawing = false; }
            function getPos(evt) { const rect = canvas.getBoundingClientRect(); return evt.type.includes('touch') ? { x: evt.touches[0].clientX - rect.left, y: evt.touches[0].clientY - rect.top } : { x: evt.clientX - rect.left, y: evt.clientY - rect.top }; }
            canvas.addEventListener('mousedown', startDrawing); canvas.addEventListener('mousemove', e => draw(getPos(e))); canvas.addEventListener('mouseup', stopDrawing); canvas.addEventListener('mouseout', stopDrawing);
            canvas.addEventListener('touchstart', e => { e.preventDefault(); startDrawing(e); }, { passive: false }); canvas.addEventListener('touchmove', e => { e.preventDefault(); draw(getPos(e)); }, { passive: false }); canvas.addEventListener('touchend', stopDrawing);
            
            resizeCanvas();
        });
    </script>
</body>
</html>
